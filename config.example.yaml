app:
  env: "local"
  name: "ichi-go"
  version: "1.0.0"
  debug: true
  locale: "en"

http:
  timeout: 10000
  port: 8080
  cors:
    allow_origins: ["*"]

http-client:
  timeout: 10000
  retry_count: 10
  retry_wait_time: 20000
  retry_max_wait: 60000
  logger_enabled: false

web:
  port: 8081

database:
  driver: "mysql"
  host: "localhost"
  port: 3306
  user: "root"
  password: "password"
  name: "mydb"
  max_idle_conns: 10
  max_open_conns: 100
  max_conn_life_time: 3600
  debug: true

cache:
  driver: "redis"
  client_name: "ichigo-cache"
  host: "localhost"
  port: 6379
  password: ""
  username: ""
  db: 0
  pool_size: 20
  timeout: 10000
  use_tls: false
  skip_verify: false

log:
  level: "debug"
  pretty: true
  request_logging:
    enabled: true
    driver: "builtin"
  requestId:
    driver: "builtin"

validator:
  default_language: "en"
  supported_languages:
    - "en"
    - "id"

auth:
  jwt:
    enabled: true
    signing_method: "HS256"
    secret_key: "dev-secret-key-change-in-production"
    token_lookup: "header:Authorization,query:token"
    auth_scheme: "Bearer"
    issuer: "myapp-dev"
    audience:
      - "myapp-dev-users"
    require_claims:
      - "sub"
      - "exp"
    access_token_ttl: "1h"    # Longer for development
    refresh_token_ttl: "720h" # 30 days for development
    leeway_duration: "5m"     # More lenient for dev
    skip_paths:
      - "/api/v1/auth/*"
      - "/api/v1/public/*"
      - "/swagger/*"
      - "/debug/*"
    private_key: "path to private key"
    public_key: "path to public key"

pkgclient:
  pokemon_api:
    base_url: "https://pokeapi.co/api/v2"
    timeout: 10000
    retry: 3

queue:
  enabled: false  # Enable/disable queue system

  rabbitmq:
    enabled: true

    # Connection settings
    connection:
      host: "localhost"
      port: 5672
      username: "guest"
      password: "guest"
      vhost: "/"
      connection_name: "ichi-go-queue"

    # Exchange definitions
    # Routes messages to queues
    exchanges:
      - name: "app.events"
        type: "topic"       # Pattern matching (user.*, payment.*)
        durable: true       # Survive restart
        auto_delete: false
        internal: false
        no_wait: false

      - name: "app.notifications"
        type: "fanout"      # Broadcast to all
        durable: true
        auto_delete: false
        internal: false
        no_wait: false

    # Producer settings (message sender)
    producer:
      exchange_name: "app.events"

    # Consumer settings (message receivers)
    consumers:
      # Email verification consumer
      - name: "email_verifier"
        enabled: true

        queue:
          name: "user.email.verification"
          durable: true
          auto_delete: false
          exclusive: false
          no_wait: false

        exchange_name: "app.events"
        routing_keys:
          - "email.verified"
          - "email.verification.requested"

        # Performance settings
        prefetch_count: 5    # Low: slow processing (email service)
        worker_pool_size: 3  # Few workers
        auto_ack: false      # Manual ack (critical)

        exclusive: false
        consumer_tag: "email_verifier_v1"

      # Payment event handler
      - name: "payment_handler"
        enabled: true

        queue:
          name: "order.payment.events"
          durable: true
          auto_delete: false
          exclusive: false

        exchange_name: "app.events"
        routing_keys:
          - "payment.completed"
          - "payment.failed"
          - "payment.refunded"

        # High throughput settings
        prefetch_count: 50   # High: fast processing
        worker_pool_size: 10 # Many workers
        auto_ack: false      # Still need reliability

        exclusive: false
        consumer_tag: "payment_handler_v1"

      # Push notifications (non-critical)
      - name: "notification_dispatcher"
        enabled: true

        queue:
          name: "user.notifications"
          durable: false     # Non-critical
          auto_delete: true  # Cleanup when idle

        exchange_name: "app.notifications"
        routing_keys: []     # Fanout ignores keys

        # Maximum speed settings
        prefetch_count: 100  # Very high
        worker_pool_size: 20 # Maximum workers
        auto_ack: true       # Speed over safety

        exclusive: false
        consumer_tag: "notifier_v1"